<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pentacle Oracle TCG</title>
    <style>
        :root {
            --gold: #d4af37;
            --magical-glow: 0 0 15px rgba(212, 175, 55, 0.6);
            /* 1000024414.jpg */
            --card-image: url('https://indices.googleusercontent.com/image_generation_content/0');
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { margin: 0; background: #000; color: #fcf6ba; font-family: 'Georgia', serif; height: 100vh; overflow: hidden; }

        /* --- モード選択画面 --- */
        #mode-select {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: radial-gradient(circle, #1a2a1a 0%, #000 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10000;
        }
        .select-title { font-size: 2.5rem; color: var(--gold); text-shadow: var(--magical-glow); margin-bottom: 40px; }
        .mode-btn {
            width: 250px; padding: 20px; margin: 10px;
            background: rgba(0,0,0,0.7); border: 2px solid var(--gold); color: var(--gold);
            font-size: 1.2rem; border-radius: 10px; cursor: pointer; transition: 0.3s;
        }
        .mode-btn:hover { background: var(--gold); color: #000; box-shadow: var(--magical-glow); }

        /* --- ゲームテーブル --- */
        #table {
            height: 100vh; width: 100vw; display: none; flex-direction: column;
            background: radial-gradient(circle at center, #0a1a0a 0%, #000000 100%);
            position: relative; transition: filter 1s ease;
        }

        #log-container { position: absolute; left: 10px; top: 10px; width: 200px; height: 100px; background: rgba(0, 0, 0, 0.7); border-left: 3px solid var(--gold); z-index: 2000; padding: 8px; font-size: 0.75rem; display: flex; flex-direction: column-reverse; pointer-events: none; overflow: hidden; }
        .log-entry { margin-bottom: 4px; border-bottom: 1px solid rgba(212, 175, 55, 0.1); }
        .log-player { color: #0ef; } .log-enemy { color: #f44; } .log-system { color: #fff; font-weight: bold; }

        .hand-area { height: 20vh; display: flex; justify-content: center; align-items: center; padding: 0 10px; z-index: 1000; }
        .field-row { width: 100%; height: 30vh; display: flex; justify-content: center; align-items: center; gap: 8px; }

        /* --- カードデザイン (画像をメインに) --- */
        .card { 
            width: 80px; height: 112px; background: #1a1a1a; border: 1.5px solid var(--gold); 
            border-radius: 6px; position: relative; transition: 0.3s; 
            flex-shrink: 0; box-shadow: 0 4px 10px rgba(0,0,0,0.8); overflow: hidden;
        }
        .card.used { transform: rotate(10deg) scale(0.9) !important; filter: brightness(0.3); }
        
        .card-img { 
            width: 100%; height: 100%; 
            background-image: var(--card-image);
            background-size: cover;
            background-position: center;
            position: absolute; top: 0; left: 0;
        }

        .card-overlay {
            position: absolute; bottom: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0) 40%, rgba(0,0,0,0.8) 90%);
            display: flex; flex-direction: column; justify-content: space-between; padding: 4px;
        }

        .card-cost { width: 18px; height: 18px; background: #0055ff; color: #fff; border-radius: 50%; font-size: 0.7rem; text-align: center; line-height: 18px; border: 1px solid #fff; }
        .card-name { font-size: 0.55rem; font-weight: bold; color: #fff; text-align: center; text-shadow: 1px 1px 2px #000; }
        .card-stats { display: flex; justify-content: space-between; }
        .stat-orb { width: 18px; height: 18px; border-radius: 50%; border: 1px solid var(--gold); font-size: 0.6rem; text-align: center; background: rgba(0,0,0,0.8); line-height: 16px; font-weight: bold; }

        /* --- HUD & ボタン --- */
        .hud { position: absolute; left: 10px; width: 140px; background: rgba(0,0,0,0.8); padding: 8px; border: 1px solid var(--gold); border-radius: 8px; z-index: 700; box-shadow: var(--magical-glow); }
        .enemy-hud { top: 22vh; } .player-hud { bottom: 22vh; }
        .hp-bar { width: 100%; height: 6px; background: #222; border-radius: 3px; overflow: hidden; margin: 4px 0; }
        .hp-fill { height: 100%; transition: width 0.5s; }
        
        #turn-btn { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: linear-gradient(#4a148c, #2a0a4a); color: var(--gold); border: 2px solid var(--gold); padding: 18px 12px; border-radius: 50%; font-weight: bold; z-index: 1000; cursor: pointer; box-shadow: var(--magical-glow); }
        .mana-charge-target { border-color: #0ef; transform: translateY(-15px); box-shadow: 0 0 15px #0ef; }

        #result-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 9999;
        }
        .result-title { font-size: 3rem; margin-bottom: 20px; }
        .win-text { color: var(--gold); text-shadow: 0 0 20px var(--gold); }
        .lose-text { color: #f44; }
    </style>
</head>
<body>

<div id="mode-select">
    <div class="select-title">Pentacle Oracle</div>
    <button class="mode-btn" onclick="startGame(1)">Beginner (HP 15)</button>
    <button class="mode-btn" onclick="startGame(2)">Standard (HP 30)</button>
    <button class="mode-btn" onclick="startGame(3)">Expert (HP 50)</button>
</div>

<div id="table">
    <div id="log-container"></div>
    <div id="enemy-hand" class="hand-area"></div>
    
    <div class="hud enemy-hud">
        <div style="font-size:0.65rem; color:#f44;">ENEMY HP: <span id="e-hp-num">30</span></div>
        <div class="hp-bar"><div id="e-hp-fill" class="hp-fill" style="background:#f44; width:100%;"></div></div>
        <div style="font-size:0.6rem; color:#f44;">Mana: <span id="e-mana-val">0</span>/<span id="e-max-mana">0</span></div>
    </div>

    <div id="enemy-field" class="field-row"></div>
    <div id="player-field" class="field-row"></div>

    <div class="hud player-hud">
        <div style="font-size:0.65rem; color:#0ef;">PLAYER HP: <span id="p-hp-num">30</span></div>
        <div class="hp-bar"><div id="p-hp-fill" class="hp-fill" style="background:#2ecc71; width:100%;"></div></div>
        <div style="font-size:0.6rem; color:#0ef;">Mana: <span id="mana-val">0</span>/<span id="max-mana">0</span></div>
    </div>

    <button id="turn-btn" onclick="nextStep()">NEXT</button>
    <div id="player-hand" class="hand-area"></div>
</div>

<div id="result-overlay">
    <div id="result-text" class="result-title"></div>
    <button class="mode-btn" onclick="location.reload()">Return</button>
</div>

<script>
    const monsterData = {
        "ミノタウロス": { cost: 3, atk: 5, hp: 5 }, 
        "スライム":     { cost: 1, atk: 1, hp: 4 },
        "ゴブリン":     { cost: 1, atk: 2, hp: 1 }, 
        "オーク":       { cost: 3, atk: 4, hp: 5 },
        "スケルトン":   { cost: 2, atk: 3, hp: 2 }, 
        "バハムート":   { cost: 6, atk: 12, hp: 10 },
        "司祭":         { cost: 4, atk: 2, hp: 8 }
    };

    let pHP = 30, eHP = 30, initialEnemyHP = 30;
    let mana = 0, maxMana = 0, eMana = 0, eMaxMana = 0;
    let isTurn = true, currentPhase = "MAIN", gameOver = false;

    function startGame(lv) {
        pHP = 30; initialEnemyHP = (lv === 1) ? 15 : (lv === 2) ? 30 : 50;
        eHP = initialEnemyHP; mana = 0; maxMana = 0;
        document.getElementById('mode-select').style.display = 'none';
        document.getElementById('table').style.display = 'flex';
        for(let i=0; i<3; i++) { drawCard('player-hand', true); drawCard('enemy-hand', false); }
        setPhase("MANA_CHARGE");
        updateUI();
        addLog(`Level ${lv} Start`, "system");
    }

    function createCard(name, isPlayer) {
        const data = monsterData[name];
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="card-img"></div>
            <div class="card-overlay">
                <div class="card-cost">${data.cost}</div>
                <div class="card-name">${name}</div>
                <div class="card-stats">
                    <div class="stat-orb" style="color:#f44;">${data.atk}</div>
                    <div class="stat-orb" style="color:#2ecc71;">${data.hp}</div>
                </div>
            </div>`;
        if (isPlayer) card.onclick = () => handleCardClick(card, data);
        return card;
    }

    function handleCardClick(card, data) {
        if (!isTurn || gameOver) return;
        if (currentPhase === "MANA_CHARGE") {
            maxMana = Math.min(maxMana + 1, 10); mana = maxMana;
            card.remove(); updateUI(); setPhase("MAIN");
        } else if (currentPhase === "MAIN") {
            if (card.parentElement.id === 'player-hand' && mana >= data.cost) {
                mana -= data.cost; document.getElementById('player-field').appendChild(card); updateUI();
                addLog(`${name} Summoned`, "player");
            } else if (card.parentElement.id === 'player-field' && !card.classList.contains('used')) {
                eHP = Math.max(0, eHP - data.atk); card.classList.add('used'); updateUI();
                addLog(`Attack: ${data.atk}`, "player");
            }
        }
    }

    function setPhase(phase) {
        currentPhase = phase;
        addLog(phase === "MANA_CHARGE" ? "Mana Charge Phase" : "Main Phase", "system");
        document.querySelectorAll('#player-hand .card').forEach(c => {
            phase === "MANA_CHARGE" ? c.classList.add('mana-charge-target') : c.classList.remove('mana-charge-target');
        });
    }

    async function nextStep() {
        if (!isTurn || gameOver) return;
        if (currentPhase === "MANA_CHARGE") return;
        isTurn = false; document.getElementById('turn-btn').innerText = "WAIT";
        await enemyTurnLogic();
        if (!gameOver) {
            isTurn = true; document.getElementById('turn-btn').innerText = "NEXT";
            drawCard('player-hand', true); drawCard('enemy-hand', false);
            document.querySelectorAll('.card').forEach(c => c.classList.remove('used'));
            setPhase("MANA_CHARGE"); updateUI();
        }
    }

    async function enemyTurnLogic() {
        addLog("Enemy Turn", "enemy");
        await new Promise(r => setTimeout(r, 1000));
        eMaxMana = Math.min(eMaxMana + 1, 10); eMana = eMaxMana;
        
        const activeCards = document.querySelectorAll('#enemy-field .card');
        for (let c of activeCards) {
            const name = c.querySelector('.card-name').innerText;
            pHP = Math.max(0, pHP - monsterData[name].atk);
            c.classList.add('used'); updateUI();
            await new Promise(r => setTimeout(r, 600));
        }

        const names = Object.keys(monsterData);
        const name = names[Math.floor(Math.random() * names.length)];
        if (eMana >= monsterData[name].cost) {
            eMana -= monsterData[name].cost;
            document.getElementById('enemy-field').appendChild(createCard(name, false));
            updateUI();
        }
    }

    function drawCard(targetId, isPlayer) {
        const hand = document.getElementById(targetId);
        if (hand.children.length < 5) {
            const names = Object.keys(monsterData);
            const name = names[Math.floor(Math.random() * names.length)];
            hand.appendChild(createCard(name, isPlayer));
        }
    }

    function updateUI() {
        document.getElementById('p-hp-num').innerText = pHP;
        document.getElementById('e-hp-num').innerText = eHP;
        document.getElementById('p-hp-fill').style.width = (pHP/30*100) + "%";
        document.getElementById('e-hp-fill').style.width = (eHP/initialEnemyHP*100) + "%";
        document.getElementById('mana-val').innerText = mana;
        document.getElementById('max-mana').innerText = maxMana;
        document.getElementById('e-mana-val').innerText = eMana;
        document.getElementById('e-max-mana').innerText = eMaxMana;
        if (eHP <= 0) showResult(true); else if (pHP <= 0) showResult(false);
    }

    function addLog(msg, type) {
        const log = document.getElementById('log-container');
        const entry = document.createElement('div');
        entry.className = `log-entry log-${type}`;
        entry.innerText = msg;
        log.insertBefore(entry, log.firstChild);
    }

    function showResult(isWin) {
        gameOver = true;
        document.getElementById('result-overlay').style.display = "flex";
        document.getElementById('result-text').innerText = isWin ? "VICTORY" : "DEFEATED";
        document.getElementById('result-text').className = `result-title ${isWin ? 'win-text' : 'lose-text'}`;
    }
</script>
</body>
</html>
